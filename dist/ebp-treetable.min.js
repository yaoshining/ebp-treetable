!function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={exports:{},id:r,loaded:!1};return e[r].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var r,a;r=[t,n(1),n(6)],a=function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(e,"__esModule",{value:!0});var a=r(t),i=r(n),o=angular.module("ebp.treetable",["ngResource",a["default"].name,i["default"].name]);e["default"]=o}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;r=[t,n(2),n(3),n(4),n(5)],a=function(e,t,n,r,a){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(e,"__esModule",{value:!0});var l=o(t),c=i(n),u=i(r),s=i(a),d=angular.module("ebpUI.layouts",[]);d.directive(l.directiveNames.ebpLayout,u["default"]).directive(l.directiveNames.ebpLayoutContainer,s["default"]);for(var p in c["default"])d.constant(p,c["default"][p]);e["default"]=d}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;r=[t],a=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.directiveNames={ebpLayout:"ebpLayout",ebpLayoutContainer:"ebpLayoutContainer"}}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;r=[t],a=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t={row:"row",column:"column"};e["default"]={EbpLayoutType:t}}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;r=[t,n(2)],a=function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){"ngInject";function n(n,r,a,i){r.addClass("ebp-layout"),a.$observe(t.directiveNames.ebpLayout,function(t){var n=t||e.row;i.layoutType=n,i.render()})}var r={restrict:"A",scope:!0,link:n,controller:i,controllerAs:"$ebpLayout"};return r}r.$inject=["EbpLayoutType"],Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t){"ngInject";n(this,e),this.layoutItems=[],this.EbpLayoutType=t}return e.$inject=["EbpLayoutType"],a(e,[{key:"render",value:function(){var e=this;this.calcSize(),this.layoutType===this.EbpLayoutType.row&&angular.forEach(this.layoutItems,function(t){t.render(e.layoutType)}),this.layoutType===this.EbpLayoutType.column&&angular.forEach(this.layoutItems,function(t){t.render(e.layoutType)})}},{key:"calcSize",value:function(){var e=0,t=[],n=[],r=!0;if(angular.forEach(this.layoutItems,function(e){e.size?(r=r&&angular.isNumber(e.size),t.push(e)):n.push(e)}),t.length<1)e=100/this.layoutItems.length;else if(r){var a=0;angular.forEach(t,function(e){a+=e.size}),e=(100-a)/n.length}else!function(){e="";var r=0,a=[];angular.forEach(t,function(e){angular.isNumber(e.size)&&(r+=e.size),angular.isString(e.size)&&a.push(e)}),a.length>0&&(e="(100%",angular.forEach(a,function(t){e+=" - "+t.size}),r>0&&(e+=" - "+r+"%"),e+=")",n.length>0&&(e+=" / "+n.length))}();angular.forEach(n,function(t){t.size=e})}}]),e}();e["default"]=r}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;r=[t,n(2)],a=function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(){function e(e,n,r,a){n.addClass("ng-hide").addClass("ebp-layout-container");var i=r[t.directiveNames.ebpLayoutContainer];if(i){var o=/^[0-9]+.?[0-9]*$/;o.test(i)?e.$ebpLayoutContainer.size=Number(i):e.$ebpLayoutContainer.size=i}a.layoutItems.push(e.$ebpLayoutContainer)}var n={restrict:"A",require:"^"+t.directiveNames.ebpLayout,scope:!0,link:e,controller:i,controllerAs:"$ebpLayoutContainer"};return n}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,r,a){"ngInject";n(this,e),this.EbpLayoutType=r,this.$ebpLayout=t.$ebpLayout,this.$el=a}return e.$inject=["$scope","EbpLayoutType","$element"],a(e,[{key:"render",value:function(e){e===this.EbpLayoutType.row&&(angular.isNumber(this.size)?this.$el.height(this.size+"%"):this.$el.height("calc("+this.size+")")),e===this.EbpLayoutType.column&&(angular.isNumber(this.size)?this.$el.width(this.size+"%"):this.$el.width("calc("+this.size+")")),this.$el.removeClass("ng-hide")}}]),e}();e["default"]=r}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;r=[t,n(7),n(8),n(9),n(10),n(11),n(12)],a=function(e,t,n,r,a,i,o){"use strict";function l(e){return e&&e.__esModule?e:{"default":e}}function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}Object.defineProperty(e,"__esModule",{value:!0});var u=c(t),s=l(n),d=l(r),p=l(a),f=l(i),h=l(o),v=angular.module("ebp.treeTable.core",[]);v.constant("defaultSettings",u.treeTableSettings).directive(u.directiveNames.ebpTreeTableCol,d["default"]).directive(u.directiveNames.ebpTreeTableCell,p["default"]).directive(u.directiveNames.ebpTreeTableNode,f["default"]).directive(u.directiveNames.ebpTreeTableHeader,h["default"]).directive(u.directiveNames.ebpTreeTable,s["default"]),e["default"]=v}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;r=[t],a=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.directiveNames={ebpTreeTable:"ebpTreetable",ebpTreeTableCol:"ebpTreetableCol",ebpTreeTableNode:"ebpTreetableNode",ebpTreeTableCell:"ebpTreetableCell",ebpTreeTableHeader:"columnheader"},e.treeTableSettings={colDefs:[],events:{edit:angular.noop,remove:angular.noop,add:angular.noop},dataSource:{read:null,drop:null}}}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;r=[t,n(7)],a=function(e,t){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){e.on("scroll",function(){var n=e.prop("scrollLeft");t.css({transform:"translate("+-n+"px, 0)"})})}function i(e,t){"ngInject";function n(){var n=e("src/treeTable/templates/treeTable.tpl.html");return{post:function(e,r,i,o){r.addClass("ebp-tt-container"),n.then(function(n){r.append(t(n)(e));var i=r.find("table").width(),l=r.width(),c=$(".ebp-tt-content-wrapper"),u=$(".ebp-tt-header-wrapper");l>=i&&r.find("table").width("100%"),a(c,u),o.render()})}}}var r={restrict:"AE",compile:n,scope:!0,controller:s,controllerAs:"$ebpTreeTable"};return r}function o(e){this.colDefs=_.sortBy(e.colDefs||[],function(e){return e.index}),this.events=e.events}function l(e,t){"ngInject";var n=t.dataSource;n.read&&(this.$readRepo=e(n.read.url,n.read.params)),n.drop&&(this.$dropRepo=e(n.drop.url,n.drop.params))}function c(e,t,n){"ngInject";var r=e.find(".ebp-tt-content-wrapper"),a=r.find("tbody");a.append(u(this.data,n,t,1)),this.hideIndexCol=function(){e.find(".ebp-tt-index-cell,.ebp-tt-index-col").hide()},this.resizeCol=function(t,n){var r=e.find("table col:nth-child("+t+")");r.width(n)}}function u(e,t,n,r){var a=_.template("<tr ebp-treetable-node></tr>"),i=$();return angular.forEach(e,function(e){var o=$(a()),l=t.$new();l.node=e,l.level=r,i=i.add(n(o)(l))}),i}i.$inject=["$templateRequest","$compile"],l.$inject=["$resource","settings"],c.$inject=["$element","$compile","$scope"],Object.defineProperty(e,"__esModule",{value:!0});var s=function d(e,a,i,s,p,f){"ngInject";var h=this;r(this,d);var v=e.$eval(a[t.directiveNames.ebpTreeTable]);v=_.merge({},i,v),o.apply(this,[v]),p.invoke(l,this,{settings:v});var b=[];this.$children=[],this.remove=function(e){_.remove(h.data,function(t){return t.id===e.id})},this.checkAll=function(t){e.$broadcast("ebp-tt-node-check",t)},this.render=function(){h.retrieve().$promise.then(function(t){h.data=t,p.invoke(c,h,{$element:s,$scope:e})})},this.reIndex=function(){var e=s.find("[ebp-treetable-node]");e.each(function(e,t){$(t).find(".ebp-tt-index-cell").text(e+1)})},this.refreshLevelNum=function(){e.$broadcast("ebp.tt.refreshLevelNum")},this.resizeMark={left:0,display:"none"},Object.defineProperties(this,{$el:{get:function(){return s}},checkedNodes:{get:function(){return b}}}),this.retrieve=function(e){var t=e?e.data.id:0;return h.$readRepo?h.$readRepo.query({id:t},function(t){if(e){var r;(r=h.data).push.apply(r,n(t));var a=u(t,e.$el.scope(),f,e.$level+1);a.insertAfter(e.$el),h.reIndex()}}):!1},this.add=function(t,n){for(var r=arguments.length,a=Array(r>2?r-2:0),i=2;r>i;i++)a[i-2]=arguments[i];var o;(o=h.data).push.apply(o,a);var l=t||0,c=e,d=1;n&&(l=t+n.$el.index(),c=n.$el.scope(),d=n.$level+1,n.isParent=!0);var p=u(a,c,f,d),v=s.find("[ebp-treetable-node]:eq("+l+")");n?p.insertAfter(v):p.insertBefore(v),h.reIndex()}};s.$inject=["$scope","$attrs","defaultSettings","$element","$injector","$compile"],e["default"]=i}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;r=[t,n(7)],a=function(e,t){"use strict";function n(){function e(e,t,n,r){var a=t.html().trim(),i={title:n.title,index:n.index,width:n.width,tpl:a},o=_.sortedIndex(r.colDefs,i.index);r.colDefs.splice(o,0,i),t.remove()}var n={restrict:"AE",link:e,require:"^"+t.directiveNames.ebpTreeTable};return n}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;r=[t,n(7)],a=function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){"ngInject";function n(t,n){n.addClass("ebp-tt-cell");var r=t.col;if(r.tpl){var a=angular.element("<div>").html(r.tpl);n.html(a),n.addClass("ebp-tt-func-cell"),e(a)(t)}}var r={restrict:"AE",link:n,scope:!1,require:"^"+t.directiveNames.ebpTreeTableNode,controller:a,controllerAs:"$cell"};return r}r.$inject=["$compile"],Object.defineProperty(e,"__esModule",{value:!0});var a=function i(){n(this,i)};e["default"]=r}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;r=[t],a=function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){}function a(){var e={restrict:"AE",scope:!1,link:r,controller:s,controllerAs:"$node"};return e}function i(e,t,r,a){"ngInject";var i=this,l=e.node,c=e.$ebpTreeTable,u=c.events,s=r("src/treeTable/templates/row.tpl.html");this.render=function(){s.then(function(n){var r=i.levelNum,u=_.template(n),s=$(u({index:t.index(),node:l,levelNum:r}));t.html(s),o.apply(i,[t,c,l,a,e])})},this.render(),this.edit=function(){var t=function(t){_.merge(l,t),e.$apply(),i.render()};u.edit(angular.copy(l,{}),t)},this.remove=function(){function e(e){function t(e){var r=e;return angular.forEach(e,function(e){e.$children&&r.push.apply(r,n(t(e.$children)))}),r}var r=t(e);angular.forEach(r,function(e){_.remove(c.data,function(t){return t.id===e.data.id}),e.$destroy()})}confirm("确定删除此条记录以及所有子记录吗?")&&c.$dropRepo.remove({id:l.id},function(){var t=_.remove(c.data,function(e){return e.id===l.id});if(t.length>0){e(i.$children);var n=i.$parent;n?(_.remove(n.$children,function(e){return e===i}),n.refreshLevelNum()):c.refreshLevelNum(),i.$destroy(),c.reIndex()}},function(){var t=_.remove(c.data,function(e){return e.id===l.id});if(t.length>0){e(i.$children);var n=i.$parent;n?(_.remove(n.$children,function(e){return e===i}),n.refreshLevelNum()):c.refreshLevelNum(),i.$destroy(),c.reIndex()}})},this.add=function(){var e=function(e,t){!t||i.$children&&e>=i.$children.length||(c.add(e,i,t),i.checked=!1)};l.isParent?i.loaded?!function(){var t=[];angular.forEach(i.$children,function(e){t.push(e.data)}),u.add(l,t,e)}():c.retrieve(i).$promise.then(function(t){u.add(l,t,e)}):u.add(l,null,e),i.$el.addClass("open")},t.on({click:function(){var e=!i.checked;c.checkAll(!1),i.checked=e}})}function o(e,t,n,r,a){function i(){this.loaded||(t.retrieve(this),this.checked=!1),angular.forEach(this.$children,function(e){e.$el.removeClass("hidden")}),e.addClass("open")}function o(e,t){angular.forEach(t,function(e){e.$el.addClass("hidden"),e.$children&&o(e.$el,e.$children)}),e.removeClass("open")}var c=this,u=t.colDefs;angular.forEach(u,function(t){var u=_.template("<td><%- node[col.name]%></td>"),s=$(u({node:n,col:t})),d=n[t.name];if(t.tpl){var p=angular.element("<div>").html(t.tpl);s.html(p),r(p)(a),s.addClass("ebp-tt-func-cell")}else if("progressBar"===t.type&&(l(s,{value:d}),s.addClass("ebp-tt-comp-cell")),"crud"===t.type){var f=$("<a>").addClass("ebp-tt-btn ebp-tt-btn-add"),h=$("<a>").addClass("ebp-tt-btn ebp-tt-btn-edit"),v=$("<a>").addClass("ebp-tt-btn ebp-tt-btn-delete");f.click(function(e){e.preventDefault(),e.stopPropagation(),c.add()}),h.click(function(e){e.preventDefault(),e.stopPropagation(),c.edit()}),v.click(function(e){e.preventDefault(),e.stopPropagation(),c.remove()}),s.append(f).append(h).append(v)}if(t.checkable&&!function(){var e=$("<label>").addClass("ebp-tt-checkbox"),t=$("<input />",{type:"checkbox"});e.append(t),e.append("<span>"),s.prepend(e),t.on({change:function(){var e=t.is(":checked");a.$broadcast("ebp-tt-node-check",e)}}),e.click(function(e){return e.stopPropagation()})}(),t.expandable){var b=20*(a.level-1);s.css({"text-indent":b+"px"}),c.expandHandler=$("<i>").addClass("ebp-tt-expand-handler"),s.prepend(c.expandHandler),c.expandHandler.on("click",function(t){t.stopPropagation(),e.is(".open")?o(e,c.$children):i.apply(c)}),n.isParent||c.expandHandler.css("visibility","hidden"),c.expand=i}e.append(s)})}function l(e,t){var n=new u(t);e.html(n.el)}i.$inject=["$scope","$element","$templateRequest","$compile"],Object.defineProperty(e,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(){function e(n){t(this,e),this.el=$('<div class="ebp-tt-progressbar">\n                    </div>'),this.bar=$('<div class="ebp-tt-progressbar-inner">\n                        </div>'),this.el.append(this.bar),this.value=n.value,this.render()}return c(e,[{key:"render",value:function(){var e=this;this.value>0?this.bar.show():this.bar.hide(),setTimeout(function(){e.bar.width(e.value+"%")},0)}}]),e}(),s=function d(e,n,r){"ngInject";var a=this;t(this,d);var o=n.$ebpTreeTable,l=!1;e.invoke(i,this,{$scope:n,$element:r}),this.$el=r,Object.defineProperties(this,{data:{get:function(){return n.node}},$level:{get:function(){return n.level}},loaded:{get:function(){return angular.isArray(a.$children)&&a.$children.length>0}},$parent:{get:function(){return n.$parent.$node}},levelIndex:{get:function(){var e=0;return e=a.$parent?_.indexOf(a.$parent.$children,a):_.indexOf(o.data,a.data)}},levelNum:{get:function(){for(var e="",t=a;t;)e=t.levelIndex+1+"."+e,t=t.$parent;return e.substring(0,e.length-1)}},isParent:{get:function(){return a.data.isParent},set:function(e){e&&a.expandHandler.css("visibility","visible"),a.data.isParent=e}},checked:{get:function(){return l},set:function(e){l=e;var t=$(".ebp-tt-checkbox > input",r);l?(o.checkedNodes.push(a),r.addClass("checked"),t.prop("checked",!0)):(_.remove(o.checkedNodes,function(e){return e===a}),r.removeClass("checked"),t.prop("checked",!1))}}}),n.$parent.$node&&(this.$parent.$children=this.$parent.$children||[],this.$parent.$children.push(this),this.$parent.isParent=!0),1===n.level&&o.$children.push(this),n.$on("ebp.tt.refreshLevelNum",function(){a.$el.find(".ebp-tt-level-cell").text(a.levelNum)}),this.refreshLevelNum=function(){n.$broadcast("ebp.tt.refreshLevelNum")},this.$destroy=function(){r.remove(),n.$destroy()},n.$on("ebp-tt-node-check",function(e,t){a.checked=t,a.$parent&&(a.$parent.checked=_.every(a.$parent.$children,"checked"))})};s.$inject=["$injector","$scope","$element"],e["default"]=a}.apply(t,r),!(void 0!==a&&(e.exports=a))},function(e,t,n){var r,a;r=[t,n(7)],a=function(e,t){"use strict";function n(e,t){var n=this,r=t.width(),i=e.$ebpTreeTable,o=i.events,l=i.resizeMark,c=e.col;interact||angular.isFunction(requirejs)&&(window.interact=requirejs("interact")),console.log("undefined"==typeof requirejs?"undefined":a(requirejs)),interact(t[0]).resizable({preserveAspectRatio:!0,edges:{left:!1,right:!0,bottom:!1,top:!1}}).on({resizestart:function(){e.$apply(function(){l.display="block"})},resizemove:function(t){e.$apply(function(){var e=t.pageX-i.$el.offset().left;l.left=e+"px",r=t.rect.width})},resizeend:function(){e.$apply(function(){e.col?e.col.width=r:i.resizeCol(t.index()+1,r),l.display="none"})}}),c&&("crud"===c.type&&!function(){var e=$("<a>").addClass("ebp-tt-btn ebp-tt-btn-insert-row"),r=function(e,t){!t||i.$children&&e>=i.$children.length||i.add(e,n,t)};e.on("click",function(e){e.preventDefault(),o.add(null,i.$children,r)}),t.addClass("ebp-tt-crud-col"),t.html(e)}(),c.checkable&&!function(){var e=$("<label>").addClass("ebp-tt-checkbox"),n=$("<input />",{type:"checkbox"});e.append(n),e.append("<span>"),t.children("div").prepend(e),n.on({change:function(){var e=n.is(":checked");i.checkAll(e)}})}())}function r(){var e={restrict:"C",scope:!1,link:n};return e}Object.defineProperty(e,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};e["default"]=r}.apply(t,r),!(void 0!==a&&(e.exports=a))}]),angular.module("ebp.treetable").run(["$templateCache",function(e){e.put("src/treeTable/templates/row.tpl.html",'<td class="ebp-tt-index-cell"><%- index+1%></td><td class="ebp-tt-level-cell"><%- levelnum%></td>'),e.put("src/treeTable/templates/treeTable.tpl.html",'<div class="ebp-tt-header"><div class="ebp-tt-header-wrapper"><table><colgroup><col class="ebp-tt-index-col"><col class="ebp-tt-level-col"><col ng-repeat="col in $ebpTreeTable.colDefs" ng-style="{width: col.width+\'px\'}"></colgroup><thead><tr><th class="columnheader ebp-tt-index-cell"></th><th class="columnheader ebp-tt-level-cell"><div>编号</div></th><th class="columnheader" ng-repeat="col in $ebpTreeTable.colDefs"><div>{{col.title}}</div></th></tr></thead></table></div></div><div class="ebp-tt-content-wrapper"><table><colgroup><col class="ebp-tt-index-col"><col class="ebp-tt-level-col"><col ng-repeat="col in $ebpTreeTable.colDefs" ng-style="{width: col.width+\'px\'}"></colgroup><tbody></tbody></table></div><div class="ebp-tt-resize-mark" ng-style="$ebpTreeTable.resizeMark"></div>')}]);